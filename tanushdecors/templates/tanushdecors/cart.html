{% extends 'tanushdecors/base.html' %}

{% load static %}

{% block title %}Tanush Decors{% endblock title %}

{% block content %}


 <!-- Cart Section -->
<div class="container">
<h2>Your Cart</h2>
<table class="table">
    <thead>
        <tr>
            <th class="product-thumbnail">Image</th>
            <th class="product-name">Product</th>
            <th class="product-price">Price</th>
            <th class="product-quantity">Quantity</th>
            <th class="product-total">Total</th>
            <th class="product-remove">Remove</th>
            <th class="product-buy">Buy Now</th> <!-- New column for Buy Now button -->
        </tr>
    </thead>
    <tbody id="cart-items">
        <!-- Cart items will be injected here by JavaScript -->
    </tbody>
</table>
</div>

  <!-- JavaScript to load cart items from localStorage -->
 
    
          
    
  <div class="row">
  <div class="col-md-12">
    <button class="btn btn-black btn-lg py-3 btn-block" onclick="proceedToCheckout()">Proceed To Checkout</button>
  </div>
  </div>
  <script>
    // Function to render the cart items from localStorage
    function renderCart() {
      const cartItemsContainer = document.getElementById('cart-items');
      cartItemsContainer.innerHTML = ''; // Clear the current cart display
  
      // Get cart from localStorage or set it to an empty array
      const cart = JSON.parse(localStorage.getItem('cart')) || [];
  
      cart.forEach(item => {
        const total = item.price * item.quantity;
        const row = `
          <tr>
            <td><img src="${item.image}" class="img-fluid" style="width: 50px;"></td>
            <td>${item.name}</td>
            <td>${item.price}</td>
            <td>${item.quantity}</td>
            <td>${total}</td>
            <td><button class="btn btn-danger" onclick="removeFromCart('${item.name}')">Remove</button></td>
            <td><button class="btn btn-primary" onclick="buyNow('${item.name}', ${item.price}, ${item.quantity})">Buy Now</button></td> <!-- Buy Now button -->
          </tr>
        `;
        cartItemsContainer.insertAdjacentHTML('beforeend', row);
      });
    }
  
    // Function to remove product from cart
    function removeFromCart(name) {
      let cart = JSON.parse(localStorage.getItem('cart')) || [];
      cart = cart.filter(item => item.name !== name); // Remove the item
      localStorage.setItem('cart', JSON.stringify(cart)); // Update localStorage
      renderCart(); // Re-render the cart
    }
  
    // Function to calculate the total price of items in the cart
    function calculateTotal(cart) {
      return cart.reduce((total, item) => total + (item.price * item.quantity), 0);
    }
  
    // Function to handle proceeding to checkout for a specific product
    function buyNow(name, price, quantity) {
      // Prepare URL parameters
      const itemsParam = `itemName0=${encodeURIComponent(name)}&itemPrice0=${price}&itemQuantity0=${quantity}`;
      // Redirect to checkout.html with the selected product details
      window.location.href = `checkout.html?${itemsParam}`;
    }
  
    // Call renderCart when the page loads
    document.addEventListener('DOMContentLoaded', renderCart);
  </script>
{% endblock content %}
